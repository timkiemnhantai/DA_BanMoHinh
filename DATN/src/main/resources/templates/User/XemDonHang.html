
<link rel="stylesheet" href="/css/style_TrangCaNhan.css" />

<div class="container">
	<!-- Sidebar -->
	<div class="sidebar">
		<div class="user-info">

			<img style="margin-left: 75px" th:src="${avatar}" alt="Avatar" onerror="this.onerror=null; this.src='/img/Screenshot_2025-06-19_220523-removebg-preview.png';">
			<strong th:text="${tendn}"></strong> <a th:href="@{/TrangCaNhan}">✎ Sửa Hồ Sơ</a>
		</div>
		<ul>
			<li><a th:href="@{/TrangCaNhan}" >Tài Khoản
					Của Tôi</a></li>
			<li><a th:href="@{/DiaChi}">Địa Chỉ</a></li>

			<li><a th:href="@{/Doimatkhau}">Đổi Mật Khẩu</a></li>

			<li><a th:href="@{/DonHang}" class="active">Đơn Mua</a></li>
		</ul>
	</div>



	<!-- Content -->
	<!-- Content -->
	<div class="content">
		<h2>Đơn hàng của tôi</h2>

		<!-- Bộ lọc trạng thái -->
	<div class="filter">
		<a th:href="@{/DonHang}">
			<button class="btn" th:classappend="${trangThai == null} ? ' active'">Tất cả</button>
		</a>
	
		<a th:href="@{/DonHang(trangThai=1)}">
			<button class="btn" th:classappend="${trangThai == 1} ? ' active'">Chờ xác nhận</button>
		</a>
	
		<a th:href="@{/DonHang(trangThai=2)}">
			<button class="btn" th:classappend="${trangThai == 2} ? ' active'">Chờ lấy hàng</button>
		</a>
	
		<a th:href="@{/DonHang(trangThai=3)}">
			<button class="btn" th:classappend="${trangThai == 3} ? ' active'">Đang giao</button>
		</a>
	
		<a th:href="@{/DonHang(trangThai=4)}">
			<button class="btn" th:classappend="${trangThai == 4} ? ' active'">Đã giao</button>
		</a>
	
		<a th:href="@{/DonHang(trangThai=6)}">
			<button class="btn" th:classappend="${trangThai == 6} ? ' active'">Hoàn thành</button>
		</a>
	
		<a th:href="@{/DonHang(trangThai=5)}">
			<button class="btn" th:classappend="${trangThai == 5} ? ' active'">Đã hủy</button>
		</a>
	
		<a th:href="@{/DonHang(trangThai=7)}">
			<button class="btn" th:classappend="${trangThai == 7} ? ' active'">Trả hàng/Hoàn tiền</button>
		</a>
	</div>




		<th:block th:each="dh, iterStat : ${dsDonHang}">
			<div class="order">
				<div class="order-head">
					<div>
						Mã đơn: <strong th:text="'DH' + ${dh.donHang.maDH}"></strong>
					</div>
					<div>
						Trạng thái: <strong th:text="${dh.donHang.trangThaiDH.tenTTDH}"></strong>
					</div>
				</div>
				<th:block th:each="ct, iterStat : ${dh.chiTietDonHangs}">
					<div class="order-items">
						<div class="item1">
							<img
								th:src="@{${
									        ct.bienTheSanPham != null 
									        and !#lists.isEmpty(ct.bienTheSanPham.anhChiTietList) 
									        ? ct.bienTheSanPham.anhChiTietList[0].urlAnhCT 
									        : (!#lists.isEmpty(ct.bienTheSanPham.sanPham.anhSanPham) 
									            ? ct.bienTheSanPham.sanPham.anhSanPham[0].urlAnhSP 
									            : '/img/default.png')
									    }
									}"
								alt="product">



							<!--  <img th:src="@{${not #lists.isEmpty(sp.bienThe.anhChiTietList) ? sp.bienThe.anhChiTietList[0].urlAnhCT : sp.bienThe.sanPham.anhSanPham[0].urlAnh}}"
							alt="" class="product-img">-->
							<div class="item-info">
								<p th:text="${ct.bienTheSanPham.sanPham.tenSP}"></p>
								<p th:text="'Số lượng: ' + ${ct.soLuongSP} + '  |  ' + 'Đơn giá: ' + ${ct.donGia}"></p>
							</div>
						</div>
					</div>
				</th:block>
				<div class="order-foot">
					Tổng tiền: <span
						th:text="${#numbers.formatDecimal(dh.donHang.thanhTien, 0, 'POINT', 0, 'COMMA')} + ' VND'"></span>
				</div>
			</div>
		</th:block>
	</div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const buttons = document.querySelectorAll('.filter .btn');

        buttons.forEach(button => {
            button.addEventListener('click', function (e) {
                // Bỏ class active khỏi tất cả nút
                buttons.forEach(btn => btn.classList.remove('active'));
                
                // Thêm class active vào nút vừa được bấm
                this.classList.add('active');
            });
        });
    });
</script>
