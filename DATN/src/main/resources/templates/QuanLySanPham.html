<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Quản lý sản phẩm</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
	<script src="https://cdn.tailwindcss.com"></script>
	<link rel="stylesheet" th:href="@{/css/Style_QuanLySanPham.css}">
</head>
<body>

<!-- Navbar -->
<nav id="navbar">
	<div class="nav-left">
		<div class="logo-wrapper flex items-center">
			<img th:src="@{/img/processed_no_white.png}" alt="Logo" />
			<div class="logo-title">Gundam Shop</div>
		</div>
	</div>
	<div class="nav-right flex items-center">
		<label>Tài khoản |</label>
		<a href="#"><img th:src="@{/img/Screenshot_2025-06-19_220523-removebg-preview.png}" alt="Tài khoản" /></a>
	</div>
</nav>

<!-- Taskbar -->
<div class="taskbar">
	<a th:href="@{/QuanLySanPham}" title="Quản lý sản phẩm"><img th:src="@{/img/box.png}" alt="" /></a>
	<a th:href="@{/QuanLyTaiKhoan}" title="Quản lý tài khoản"><img th:src="@{/img/account.png}" alt="" /></a>
	<a th:href="@{/QuanLyDonHang}" title="Quản lý đơn hàng"><img th:src="@{/img/booking.png}" alt="" /></a>
	<a href="#" title="Quản lý đánh giá"><img th:src="@{/img/review.png}" alt="" /></a>
	<a th:href="@{/QuanLyBanner}" title="Quản lý banner"><img th:src="@{/img/advertisement.png}" alt="" /></a>
	<a href="#" title="Quản lý thanh toán"><img th:src="@{/img/credit-card.png}" alt="" /></a>
</div>

<!-- Nội dung chính -->
<div class="container-admin">
	<div class="bg-white rounded-lg shadow p-5">
		<div class="flex justify-between items-center mb-4">
			<h1 class="text-xl font-bold">Quản lý sản phẩm</h1>
			<a th:href="@{/QuanLySanPham/create}" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Thêm sản phẩm</a>
		</div>

		<!-- Form tìm kiếm -->
		<form method="get" th:action="@{/QuanLySanPham}" class="flex mb-4 gap-4 flex-wrap">
			<input type="text" name="keyword" placeholder="Tìm sản phẩm..."
				   class="flex-1 border px-3 py-2 rounded" th:value="${keyword}"/>

			<select name="loaiKeyword" class="border px-3 py-2 rounded">
				<option value="">Tất cả loại</option>
				<option value="Bandai" th:selected="${loaiKeyword == 'Bandai'}">Bandai</option>
				<option value="High Grade" th:selected="${loaiKeyword == 'High Grade'}">High Grade</option>
				<option value="Real Grade" th:selected="${loaiKeyword == 'Real Grade'}">Real Grade</option>
				<option value="Master Grade" th:selected="${loaiKeyword == 'Master Grade'}">Master Grade</option>
				<option value="Perfect Grade" th:selected="${loaiKeyword == 'Perfect Grade'}">Perfect Grade</option>
				<option value="MOSHOWTOYS" th:selected="${loaiKeyword == 'MOSHOWTOYS'}">MOSHOWTOYS</option>
				<option value="IN ERA+" th:selected="${loaiKeyword == 'IN ERA+'}">IN ERA+</option>
				<option value="SNAA" th:selected="${loaiKeyword == 'SNAA'}">SNAA</option>
				<option value="MOTOR NUCLEAR" th:selected="${loaiKeyword == 'MOTOR NUCLEAR'}">MOTOR NUCLEAR</option>
			</select>

			<select name="sapXep" class="border px-3 py-2 rounded">
				<option value="">Sắp xếp</option>
				<option value="banchay" th:selected="${sapXep == 'banchay'}">Bán chạy</option>
				<option value="giathap" th:selected="${sapXep == 'giathap'}">Giá thấp</option>
				<option value="giacao" th:selected="${sapXep == 'giacao'}">Giá cao</option>
			</select>

			<label class="flex items-center gap-1">
				<input type="checkbox" name="giamGia" th:checked="${giamGia != null}" />
				Giảm giá
			</label>

			<button type="submit" class="bg-gray-300 px-4 py-2 rounded hover:bg-gray-400">
				<i class="fas fa-search"></i>
			</button>
		</form>

		<!-- Bảng sản phẩm -->
		<div class="overflow-x-auto">
			<table class="min-w-full border text-sm">
				<thead class="bg-gray-100">
				<tr>
					<th class="p-2 border text-center">Mã SP</th>
					<th class="p-2 border text-center">Tên sản phẩm</th>
					<th class="p-2 border text-center">Ảnh</th>
					<th class="p-2 border text-center">Loại</th>
					<th class="p-2 border text-center">Hãng</th>
					<th class="p-2 border text-center">Giá</th>
					<th class="p-2 border text-center">Tồn kho</th>
					<th class="p-2 border text-center">Trạng thái</th>
					<th class="p-2 border text-center">Hành động</th>
				</tr>
				</thead>
				<tbody>
				<tr th:each="spDTO : ${danhSachSanPham}" class="hover:bg-gray-50 text-center">
					<td class="p-2 border" th:text="${spDTO.maSP}"></td>
					<td class="p-2 border" th:text="${spDTO.tenSP}"></td>
					<td class="p-2 border">
						<img th:if="${spDTO.anhSanPham.size() > 0}"
							 th:src="${spDTO.anhSanPham[0].urlAnhSP}"
							 class="w-[150px] h-[150px] object-cover rounded mx-auto"/>
						<span th:if="${spDTO.anhSanPham.size() == 0}">Chưa có ảnh</span>
					</td>
					<td class="p-2 border" th:text="${spDTO.loaiSanPham.tenLoaiSanPham}"></td>
					<td class="p-2 border">
							<span class="px-2 py-1 bg-yellow-200 text-red-800 rounded-full text-xs"
								  th:text="${spDTO.thuongHieu}"></span>
					</td>
					<td class="p-2 border text-blue-600 font-semibold">
							<span th:if="${!spDTO.bienTheSanPham.isEmpty()}"
								  th:text="${#numbers.formatDecimal(spDTO.bienTheSanPham[0].gia, 0, 'COMMA', 0, 'POINT')} + ' ₫'"></span>
					</td>

					<td class="p-2 border">
						    <span th:if="${spDTO.bienTheSanPham != null and !spDTO.bienTheSanPham.isEmpty()}"
								  th:text="${spDTO.bienTheSanPham[0].soLuongTonKho}">
						    </span>
					</td>

					<td class="p-2 border">
						    <span th:if="${spDTO.bienTheSanPham != null and !spDTO.bienTheSanPham.isEmpty()
						                  and spDTO.bienTheSanPham[0].soLuongTonKho > 5}"
								  class="px-2 py-1 bg-green-200 text-green-800 rounded-full text-xs">
						        Còn hàng
						    </span>

						<span th:if="${spDTO.bienTheSanPham != null and !spDTO.bienTheSanPham.isEmpty()
						                  and spDTO.bienTheSanPham[0].soLuongTonKho > 0
						                  and spDTO.bienTheSanPham[0].soLuongTonKho <= 5}"
							  class="px-2 py-1 bg-yellow-200 text-yellow-800 rounded-full text-xs">
						        Sắp về
						    </span>

						<span th:if="${spDTO.bienTheSanPham != null and !spDTO.bienTheSanPham.isEmpty()
						                  and spDTO.bienTheSanPham[0].soLuongTonKho == 0}"
							  class="px-2 py-1 bg-red-400 text-red-800 rounded-full text-xs">
						        Hết hàng
						    </span>
					</td>


					<td class="p-2 border">
						<div class="flex justify-center gap-2">
							<a th:href="@{'/QuanLySanPham/edit/' + ${spDTO.maSP}}">
								<i class="fas fa-pen text-blue-600 cursor-pointer"></i>
							</a>
							<a th:href="@{'/QuanLySanPham/delete/' + ${spDTO.maSP}}"
							   onclick="return confirm('Bạn có chắc chắn muốn xóa?')">
								<i class="fas fa-trash text-red-600 cursor-pointer"></i>
							</a>
						</div>
					</td>
				</tr>
				</tbody>
			</table>
		</div>

	</div>
</div>

</body>
</html>
