<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" href="/css/style.css" />
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<script src="https://cdn.tailwindcss.com"></script>
<meta name="_csrf" th:content="${_csrf.token}" />
<meta name="_csrf_header" th:content="${_csrf.headerName}" />
</head>
<body>
	<nav id="navbar-curd">
		<div class="nav-left">
			<div class="logo-wrapper">
				<img src="/img/processed_no_white.png" alt="Logo" />
				<div class="logo-title">Gundam Shop</div>
			</div>
		</div>
		<div class="nav-right relative">
			<button id="accountToggle"
				class="flex items-center space-x-2 focus:outline-none">
				<span class="text-gray-700 font-medium">Tài khoản</span> <img
					src="/img/Screenshot_2025-06-19_220523-removebg-preview.png"
					alt="Tài khoản" class="h-10 w-10 object-cover rounded-full" />
			</button>

			<div id="accountMenu"
				class="hidden absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded shadow-lg z-10">
				<a href="TrangCaNhan.html"
					class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Thông
					tin cá nhân</a> <a th:href="@{/logout}"
					class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Đăng
					xuất</a>
			</div>
		</div>
	</nav>

	<!-- ========== TASKBAR ========== -->
	<div class="taskbar">

		<!-- Chỉ ADMIN thấy -->
		<a th:href="@{/QuanLySanPham}" title="Quản lý sản phẩm"
			sec:authorize="hasAnyAuthority('Admin', 'Nhân viên')"> <img
			src="/img/box.png" alt="" />
		</a>

		<!-- Chỉ ADMIN thấy -->
		<a th:href="@{/QuanLyTaiKhoan}" title="Quản lý tài khoản"
			sec:authorize="hasAuthority('Admin')"> <img
			src="/img/account.png" alt="" />
		</a>

		<!-- ADMIN và NHANVIEN đều thấy -->
		<a th:href="@{/QuanLyDonHang}" title="Quản lý đơn hàng"
			sec:authorize="hasAnyAuthority('Admin', 'Nhân viên')"> <img
			src="/img/booking.png" alt="" />
		</a>

		<!-- ADMIN và NHANVIEN đều thấy -->
		<a th:href="@{/QuanLyDanhGia}" title="Quản lý đánh giá"
			sec:authorize="hasAnyAuthority('Admin', 'Nhân viên')"> <img
			src="/img/review.png" alt="" />
		</a>

		<!-- Chỉ ADMIN thấy -->
		<a th:href="@{/QuanLyBanner}" title="Quản lý banner"
			sec:authorize="hasAuthority('Admin')"> <img
			src="/img/advertisement.png" alt="" />
		</a>

		<!-- Chỉ ADMIN thấy -->
		<a th:href="@{/QuanLyThanhToan}" title="Quản lý thanh toán"
			sec:authorize="hasAuthority('Admin')"> <img
			src="/img/credit-card.png" alt="" />
		</a>
		
		<a th:href="@{/QuanLyGiamGia}" title="Quản lý giảm giá"
			sec:authorize="hasAnyAuthority('Admin', 'Nhân viên')"> <img
			src="/img/coupon.png" alt="" />
		</a>
	</div>


	<div th:replace="~{${content}}"></div>

	<div id="confirm-modal" class="modal-overlay hidden">
		<div class="modal-content"
			style="background: white; padding: 24px; border-radius: 10px; max-width: 400px; text-align: center;">
			<p id="confirm-message"></p>
			<div class="modal-actions">
				<button id="confirm-yes" class="btn btn-danger">Xác nhận</button>
				<button id="confirm-no" class="btn btn-secondary">Hủy</button>
			</div>
		</div>
	</div>
</body>
</html>
<script>
    const toggleBtn = document.getElementById('accountToggle');
    const menu = document.getElementById('accountMenu');

    toggleBtn.addEventListener('click', function () {
      menu.classList.toggle('hidden');
    });

    document.addEventListener('click', function (event) {
      if (!toggleBtn.contains(event.target) && !menu.contains(event.target)) {
        menu.classList.add('hidden');
      }
    });
    
    function showConfirm(message, onConfirm) {
  	  const modal = document.getElementById("confirm-modal");
  	  const messageEl = document.getElementById("confirm-message");
  	  const yesBtn = document.getElementById("confirm-yes");
  	  const noBtn = document.getElementById("confirm-no");

  	  messageEl.textContent = message;
  	  modal.classList.remove("hidden");

  	  const close = () => modal.classList.add("hidden");

  	  yesBtn.onclick = () => {
  	    close();
  	    onConfirm();
  	  };
  	  noBtn.onclick = close;
  	}
  </script>